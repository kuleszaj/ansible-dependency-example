# Ansible Dependency Example

You can tweak and run yourself with `ansible-playbook -i localhost site.yml`

## Using vars: in deps.

e.g.

```
# Role1
dependencies:
- name: lc.test-dep
  vars:
    var1: Set in Role1
    var2: Set in Role1

# Role2
dependencies:
- name: lc.test-dep
  vars:
    var1: Set in Role2  
```

Results in:

```
PLAY [localhost] ***************************************************************************************************************************************************************************************************************************************************************

TASK [Gathering Facts] *********************************************************************************************************************************************************************************************************************************************************
ok: [localhost]

TASK [lc.test-dep : This is the test-dep role! I'm a dependency of both Role1 and Role2. Here is the value of var1 --] *********************************************************************************************************************************************************
ok: [localhost] => {
    "var1": "Set in Role1"
}

TASK [lc.test-dep : This is the test-dep role! I'm a dependency of both Role1 and Role2. Here is the value of var2 --] *********************************************************************************************************************************************************
ok: [localhost] => {
    "var2": "Set in Role1"
}

TASK [lc.test-dep : This is the test-dep role! I'm a dependency of both Role1 and Role2. Here is the value of var1 --] *********************************************************************************************************************************************************
ok: [localhost] => {
    "var1": "Set in Role2"
}

TASK [lc.test-dep : This is the test-dep role! I'm a dependency of both Role1 and Role2. Here is the value of var2 --] *********************************************************************************************************************************************************
ok: [localhost] => {
    "var2": "Set in Role1"
}

PLAY RECAP *********************************************************************************************************************************************************************************************************************************************************************
localhost                  : ok=5    changed=0    unreachable=0    failed=0

```


## Using params in deps.

e.g.

```
# Role1
dependencies:
- name: lc.test-dep
  var1: Set in Role1
  var2: Set in Role1

# Role2
dependencies:
- name: lc.test-dep
  var1: Set in Role2    
```

Results in:

```
PLAY [localhost] ***************************************************************************************************************************************************************************************************************************************************************

TASK [Gathering Facts] *********************************************************************************************************************************************************************************************************************************************************
ok: [localhost]

TASK [lc.test-dep : This is the test-dep role! I'm a dependency of both Role1 and Role2. Here is the value of var1 --] *********************************************************************************************************************************************************
ok: [localhost] => {
    "var1": "Set in Role1"
}

TASK [lc.test-dep : This is the test-dep role! I'm a dependency of both Role1 and Role2. Here is the value of var2 --] *********************************************************************************************************************************************************
ok: [localhost] => {
    "var2": "Set in Role1"
}

TASK [lc.test-dep : This is the test-dep role! I'm a dependency of both Role1 and Role2. Here is the value of var1 --] *********************************************************************************************************************************************************
ok: [localhost] => {
    "var1": "Set in Role2"
}

TASK [lc.test-dep : This is the test-dep role! I'm a dependency of both Role1 and Role2. Here is the value of var2 --] *********************************************************************************************************************************************************
ok: [localhost] => {
    "var2": ""
}

PLAY RECAP *********************************************************************************************************************************************************************************************************************************************************************
localhost                  : ok=5    changed=0    unreachable=0    failed=0

```

## Other notes...

For comparison, setting the vars for the roles via `include_role` does not show the same behavior:

```
---
- hosts: localhost
  tasks:
  - include_role: 
      name: lc.test-role1
    vars:
      var1: Role1
      var2: Role1
  - include_role:
      name: lc.test-role2
    vars:
      var1: Role2
```

Results in:

```
PLAY [localhost] ***************************************************************************************************************************************************************************************************************************************************************

TASK [Gathering Facts] *********************************************************************************************************************************************************************************************************************************************************
ok: [localhost]

TASK [include_role : lc.test-role1] ********************************************************************************************************************************************************************************************************************************************

TASK [lc.test-dep : This is the test-dep role! I'm a dependency of both Role1 and Role2. Here is the value of var1 --] *********************************************************************************************************************************************************
ok: [localhost] => {
    "var1": "Role1"
}

TASK [lc.test-dep : This is the test-dep role! I'm a dependency of both Role1 and Role2. Here is the value of var2 --] *********************************************************************************************************************************************************
ok: [localhost] => {
    "var2": "Role1"
}

TASK [include_role : lc.test-role2] ********************************************************************************************************************************************************************************************************************************************

TASK [lc.test-dep : This is the test-dep role! I'm a dependency of both Role1 and Role2. Here is the value of var1 --] *********************************************************************************************************************************************************
ok: [localhost] => {
    "var1": "Role2"
}

TASK [lc.test-dep : This is the test-dep role! I'm a dependency of both Role1 and Role2. Here is the value of var2 --] *********************************************************************************************************************************************************
ok: [localhost] => {
    "var2": ""
}

PLAY RECAP *********************************************************************************************************************************************************************************************************************************************************************
localhost                  : ok=5    changed=0    unreachable=0    failed=0
```